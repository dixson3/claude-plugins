# Fix Truncated Plan ID in Bead Creation

**Status:** Completed

## Context

When creating beads for plans with hybrid idx-hash filenames (e.g., `plan-0001-xfv50.md`), beads are labeled `plan:0001` instead of the correct `plan:0001-xfv50`. This breaks all downstream bead queries (`bd list -l plan:...`) because the labels don't match.

**Root cause**: The shell scripts correctly extract the full ID (`sed 's/^plan-//'`), but the SKILL.md files — which instruct the LLM — show only legacy numeric examples (e.g., `plan-03.md -> 03`), causing the LLM to drop the hash suffix during extraction.

## Changes

### Part 1: Primary fix — extraction instructions (root cause)

**`plugins/yf/skills/plan_create_beads/SKILL.md`**
- Line 42: Replace extraction instruction to show hybrid ID extraction:
  - `plan-03.md -> 03` becomes `plan-0054-gs93u.md -> 0054-gs93u` (strip `plan-` prefix and `.md` suffix)
- Line 178: Update summary example from `plan-03` to `plan-<idx>`

**`plugins/yf/skills/plan_intake/SKILL.md`**
- Line 7: Update argument description example from `plan-15.md or 15` to hybrid format
- Line 71-72: Update extraction instructions to show hybrid ID format

### Part 2: Argument descriptions — reinforce correct format across skills

Update `description` fields showing bare numeric examples to hybrid format in:

| File | Line | Current | New |
|------|------|---------|-----|
| `skills/plan_execute/SKILL.md` | 9 | `(e.g., 03)` | `(e.g., 0003-a3x7m)` |
| `skills/plan_pump/SKILL.md` | 6 | `(e.g., 07)` | `(e.g., 0007-b4m2k)` |
| `skills/chronicle_diary/SKILL.md` | 6 | `(e.g., 07)` | `(e.g., 0007-b4m2k)` |
| `skills/archive_process/SKILL.md` | 6 | `(e.g., 19)` | `(e.g., 0019-k4m9q)` |
| `skills/swarm_qualify/SKILL.md` | 6 | `(e.g., 29)` | `(e.g., 0029-j7n3p)` |
| `skills/engineer_suggest_updates/SKILL.md` | 6 | `(e.g., 34)` | `(e.g., 0034-m8q2r)` |
| `skills/engineer_reconcile/SKILL.md` | 9 | `(e.g., 34)` | `(e.g., 0034-m8q2r)` |

### Part 3: Naming convention table

**`plugins/yf/skills/plan_engage/SKILL.md`**
- Line 52: Update index determination instruction to mention hybrid format
- Lines 143-144: Update naming table examples from `plan-03.md` / `plan-03-part1-api.md` to hybrid format

### Part 4: Regression test

Add a test step (new scenario or extend existing) that greps all SKILL.md files for bare numeric plan ID examples like `e.g., 03)` or `plan-03.md` to prevent regression.

## Files modified (all under `plugins/yf/`)

1. `skills/plan_create_beads/SKILL.md` — primary extraction fix
2. `skills/plan_intake/SKILL.md` — argument + extraction fix
3. `skills/plan_execute/SKILL.md` — argument example
4. `skills/plan_pump/SKILL.md` — argument example
5. `skills/chronicle_diary/SKILL.md` — argument example
6. `skills/archive_process/SKILL.md` — argument example
7. `skills/swarm_qualify/SKILL.md` — argument example
8. `skills/engineer_suggest_updates/SKILL.md` — argument example
9. `skills/engineer_reconcile/SKILL.md` — argument example
10. `skills/plan_engage/SKILL.md` — naming table + index instruction

## Not changed (already correct)

- All shell scripts (`code-gate.sh`, `exit-plan-gate.sh`, `session-recall.sh`, `bd-safety-net.sh`, `plan-exec.sh`) — already extract full hybrid IDs
- Skills that inherit plan labels from bead context rather than filenames (`chronicle_capture`, `archive_capture`, `plan_breakdown`, etc.)

## Verification

1. `bash tests/run-tests.sh --unit-only` — existing tests pass
2. Grep check: `grep -rn 'e\.g\., [0-9]\+)' plugins/yf/skills/*/SKILL.md` returns no bare numeric plan ID examples
3. Grep check: `grep -rn 'plan-03' plugins/yf/skills/*/SKILL.md` returns no legacy-only examples
