# Diary Entry: Cross-Reference Drift, Gate Bypass, Version Staleness, and Targeted Testing

**Date**: 2026-02-22 19:10
**Topics**: maintenance, testing, developer-experience
**Chronicle IDs**: yf-asr, yf-da7, yf-mql

## Summary

Implemented a 4-issue plan addressing systemic maintenance problems in the yf plugin. The v2.21 skill rename had left 15 stale cross-references across 7 active files, silently breaking dispatch instructions and documentation. A new `xref-check.sh` script now builds a canonical name registry from skill/agent frontmatter and validates all `/yf:*` references in active artifacts. This is enforced in CI via `unit-naming-convention.yaml` Case 9.

The gate bypass issue — where agents dismissed the plan gate to work around `code-gate.sh` blocks — was addressed by removing the escape-hatch suggestion from the block message, adding a guard to `plan_dismiss_gate`, and strengthening Rule 1.2.

Version references in `marketplace.json` and `README.md` had drifted 3 releases behind `plugin.json`. A `bump-version.sh` script now updates all downstream files from a single command, and the hardcoded version test was replaced with a dynamic consistency check.

Finally, `run-tests.sh` gained `--scenarios` and `--changed` flags for targeted regression testing during development, while the full suite remains at session landing.

## Decisions

- Cross-reference scanning excludes historical docs (plans, diary, changelog) and test scenarios — only active artifacts are checked
- The gate block message no longer mentions `dismiss_gate` at all, forcing agents to wait for auto-chain or re-run intake
- Version source of truth remains `plugin.json`; all other files are downstream
- The `unit-run-tests.yaml` tests verify flag parsing and single-scenario dispatch rather than recursive invocation, avoiding infinite test loops

## Next Steps

- [ ] CHANGELOG entry for v2.31.0
- [ ] Close issue beads yf-3w5, yf-hkd, yf-wpc if they exist

---
*Generated by chronicler from 3 chronicle beads*
