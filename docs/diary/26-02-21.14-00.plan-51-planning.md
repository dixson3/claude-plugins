# Diary Entry: Plan 51 â€” Beads Gitignore Allowlist, Git Worktree Support, and Legacy Cleanup

**Date**: 2026-02-21 14:00
**Operator**: James Dixson
**Topics**: planning, feature, plan-51, beads, gitignore, git-worktree
**Chronicle IDs**: yf-8fx, yf-dog, yf-m6l, yf-map

## Summary

Following the Plan 50 issue tracking implementation, we turned our attention to three infrastructure improvements that had been accumulating as TODOs. Plan 51 bundles them together: converting the beads gitignore from a blocklist to an allowlist, adding git worktree support with redirect-based implementation, and removing legacy pre-dolt migration code.

The gitignore situation had grown unwieldy. The beads project's `setup-project.sh` maintained a 57-line blocklist enumerating every file pattern to ignore. We planned to replace it with a 4-line allowlist that tracks only the `.beads/` subdirectories the application actually needs, ignoring everything else. The intent becomes explicit rather than requiring constant maintenance as new file types appear.

Git worktree support addressed a fundamental assumption baked into the yf plugin: that there is a single working tree. With the swarm isolation work from v2.27.0 introducing parallel worktrees, we needed hooks and preflight to follow. Plan 51 specifies a redirect-based implementation -- using redirects rather than path normalization to handle worktree detection -- keeping the hook infrastructure simple and avoiding complex path translation logic.

The legacy code removal targets pre-dolt migration paths still present in `beads-setup.sh`. With the dolt backend firmly established since v0.52.0 and the sync mechanisms cleaned up in Plans 45-47, this migration code was dead weight.

Intake reconciliation passed structural consistency checks at 5/6 items, with one pre-existing UC count parity issue noted. Spec changes for UC-025 Steps 5 and 7 (worktree redirect implementation) were approved. No contradictions were found against existing specifications, and the new worktree redirect capability is properly covered by the plan's step definitions.

## Decisions

- **Allowlist over blocklist**: Converting from a 57-line blocklist to a 4-line allowlist simplifies gitignore maintenance and makes the intent (track only specific necessary directories) more explicit.
- **Redirect-based worktree support**: Using redirects rather than path normalization to handle git worktrees keeps the hook infrastructure simple and avoids complex path translation logic.
- **Spec changes approved**: UC-025 Steps 5+7 updates for worktree redirect implementation were approved as part of plan intake.

## Next Steps

- [ ] Implement beads gitignore allowlist conversion (Step 1-2)
- [ ] Add git worktree support via redirect-based implementation (Step 5-7)
- [ ] Remove legacy pre-dolt migration code from beads-setup.sh (Step 3-4)
- [ ] Update hook documentation for worktree awareness (Step 8)
- [ ] Review and approve UC-025 updates (already approved, included in plan)

---
*Generated by chronicler from 4 chronicle beads*
