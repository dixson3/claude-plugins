# Diary Entry: The Great Unshackling â€” beads-cli Removal and v3.0.0 (Plan 0056)

**Date**: 2026-02-23
**Operator**: James Dixson
**Topics**: architecture, dependencies, v3.0.0, file-based-tasks
**Chronicle IDs**: yf-d2w, yf-syn

## Summary

For months the yf plugin's activation gate had three conditions: config exists, enabled flag set, and beads-cli installed. That third condition -- an external CLI backed by an embedded dolt database -- was the heaviest dependency in the stack. Every new project needed `brew install beads` before yf would do anything. Plan 0056 ripped it out entirely and replaced it with something that had been hiding in plain sight: JSON files on disk, managed by shell functions, tracked (or not) by git.

The replacement landed as a self-contained file-based task system under `.yoshiko-flow/` subdirectories. Where `bd create` once wrote rows into dolt, `yft_create` now writes a JSON file into `.yoshiko-flow/tasks/`. Where `bd list --ready` queried a database, `yft_list --ready` scans a directory with `jq`. The operational semantics stayed identical -- IDs, labels, dependencies, gates, status transitions -- but the machinery underneath went from a 50MB binary with a SQL engine to a handful of shell functions and `jq`.

The migration touched 91 significant files across the plugin: every skill, every agent, every hook, every script that referenced `bd` commands. The version jumped to 3.0.0 because this was genuinely breaking -- any project with `.beads/` state would need to be aware that the tool no longer reads from that directory. The activation gate simplified to two conditions, the preflight stopped checking for an external binary, and the CHANGELOG grew its longest entry yet.

## Decisions

- **JSON over SQLite**: Shell scripts already depended on `jq` for dispatch-state and config files. Adding another format would have meant another parser. JSON files in directories gave us the same query patterns through `find` and `jq` that `bd list` provided through SQL.
- **Gitignore by default**: Task directories under `.yoshiko-flow/` are gitignored. The permanent records live in `docs/plans/` and `docs/diary/` -- the task files are ephemeral runtime state, same as they were under `.beads/dolt/`.
- **Wrapper script as agent interface**: Agents call `bash $CLAUDE_PLUGIN_ROOT/scripts/yf-task-cli.sh <cmd> <args>` rather than importing a library. This keeps the interface stable even as the internal implementation evolves.

## Next Steps

- [x] Specification alignment (Plan 0057) -- completed same session
- [ ] Monitor for any edge cases in molecule wisp/squash lifecycle under the new system

---
*Generated by chronicler from 2 chronicle entries*
